version: 1
source:
  query: with t1 as (select * from slide.f_booking_stg) select * from t1
target:
  table: adw.f_booking 
  operation: upsert
  where_statement_on_table: date > current_date() - 7
  create_staging_table: True
  primary_key_columns: 
    - booking_id
    - date
  update_columns:
    - fare
    - passenger_id
    - country_id    
  pre_sql: select 1 as c1